https://github.com/haikuports/haikuports/blob/master/www-client/retawq/patches/retawq-0.2.6c.patchset
--- resource.c	Sun Mar 19 07:21:20 2006
+++ resource.c	Sat Apr 19 16:41:46 2014
@@ -9,6 +9,8 @@
 #include "stuff.h"
 #include "resource.h"
 #include "parser.h"
+#include <sys/socket.h>
+#include <netinet/in.h>
 
 #if CAN_HANDLE_SIGNALS
 #include <signal.h>
@@ -2271,7 +2273,7 @@ static one_caller tBoolean tls_initialize(void)
         my_spf_cleanup(debugstrbuf, spfbuf);
       }
 #endif
-      if (RAND_egd(seedfilename) >= 0) goto rand_finish;
+      if (RAND_bytes(seedfilename, 255) >= 0) goto rand_finish;
       debugmsg("TLS: random D\n");
       (void) RAND_load_file(seedfilename, -1);
         /* ("-1" is allowed for OpenSSL >= 0.9.5) */

--- resource.c
+++ resource.c	2025-08-11 18:43:03.000000000 +0800
@@ -2481,8 +2481,6 @@
   conn->tls_session = session;
   err = gnutls_set_default_priority(session);
   tls_gnutls_debug("set default priority", err);
-  err = gnutls_certificate_type_set_priority(session, cert_type_priority);
-  tls_gnutls_debug("set certificate type priority", err);
   err = gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, tls_xcred);
   tls_gnutls_debug("set credentials", err);
   gnutls_transport_set_ptr(session, (my_gnutls_transport_ptr) conn->fd);
