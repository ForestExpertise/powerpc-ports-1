From ea9ad225b6631794a38c1b904b4a4442c2cf4020 Mon Sep 17 00:00:00 2001
From: Sergey Fedorov <barracuda@macos-powerpc.org>
Date: Fri, 11 Apr 2025 17:36:42 +0800
Subject: [PATCH 06/60] VideoDock.*: compat

---
 src/gui/VideoDock.cpp | 11 +++++++----
 src/gui/VideoDock.hpp |  1 +
 2 files changed, 8 insertions(+), 4 deletions(-)

diff --git a/src/gui/VideoDock.cpp b/src/gui/VideoDock.cpp
index 74485f76..e90c5773 100644
--- a/src/gui/VideoDock.cpp
+++ b/src/gui/VideoDock.cpp
@@ -38,6 +38,12 @@
 
 constexpr int g_hideCursorTimeout = 750;
 
+void VideoDock::onDockVideo(QWidget *w)
+{
+    iDW.setWidget(w);
+    mouseMoveEvent(nullptr);
+}
+
 VideoDock::VideoDock() :
     isTouch(false), touchEnded(false),
     iDW(QMPlay2GUI.grad1, QMPlay2GUI.grad2, QMPlay2GUI.qmpTxt),
@@ -88,10 +94,7 @@ VideoDock::VideoDock() :
     connect(&iDW, SIGNAL(resized(int, int)), this, SLOT(resizedIDW(int, int)));
     connect(&iDW, SIGNAL(hasCoverImage(bool)), this, SLOT(hasCoverImage(bool)));
     connect(this, SIGNAL(visibilityChanged(bool)), this, SLOT(visibilityChanged(bool)));
-    connect(&QMPlay2Core, &QMPlay2CoreClass::dockVideo, this, [this](QWidget *w) {
-        iDW.setWidget(w);
-        mouseMoveEvent(nullptr);
-    });
+    connect(&QMPlay2Core, SIGNAL(dockVideo(QWidget *)), this, SLOT(onDockVideo(QWidget *)));
 
     if ((isBreeze = QApplication::style()->objectName() == "breeze"))
         setStyle(&commonStyle);
diff --git a/src/gui/VideoDock.hpp b/src/gui/VideoDock.hpp
index bd26b3f9..476ce460 100644
--- a/src/gui/VideoDock.hpp
+++ b/src/gui/VideoDock.hpp
@@ -76,6 +76,7 @@ private slots:
     void updateImage(const QImage &);
     void visibilityChanged(bool);
     void hasCoverImage(bool);
+    void onDockVideo(QWidget *w);
 signals:
     void resized(int, int);
     void itemDropped(const QString &, bool);
-- 
2.49.0

