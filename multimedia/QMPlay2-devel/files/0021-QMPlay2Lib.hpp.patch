From 8bb6cf089ef054aa7722ba0257c742c64a73b93a Mon Sep 17 00:00:00 2001
From: Sergey Fedorov <barracuda@macos-powerpc.org>
Date: Tue, 15 Apr 2025 21:02:17 +0800
Subject: [PATCH 21/60] QMPlay2Lib.hpp

---
 src/qmplay2/headers/QMPlay2Lib.hpp | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)

diff --git a/src/qmplay2/headers/QMPlay2Lib.hpp b/src/qmplay2/headers/QMPlay2Lib.hpp
index 0d1f1016..8bc2a569 100644
--- a/src/qmplay2/headers/QMPlay2Lib.hpp
+++ b/src/qmplay2/headers/QMPlay2Lib.hpp
@@ -20,8 +20,13 @@
 
 #include <QtGlobal>
 
-#if defined(QMPLAY2SHAREDLIB_LIBRARY)
-    #define QMPLAY2SHAREDLIB_EXPORT Q_DECL_EXPORT
+#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)
+    // Define to nothing, it breaks linking otherwise
+    #define QMPLAY2SHAREDLIB_EXPORT
 #else
-    #define QMPLAY2SHAREDLIB_EXPORT Q_DECL_IMPORT
+    #if defined(QMPLAY2SHAREDLIB_LIBRARY)
+        #define QMPLAY2SHAREDLIB_EXPORT Q_DECL_EXPORT
+    #else
+        #define QMPLAY2SHAREDLIB_EXPORT Q_DECL_IMPORT
+    #endif
 #endif
-- 
2.49.0

