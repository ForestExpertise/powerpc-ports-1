From a8fb2246577d0915315c5f0c0efc73644118afab Mon Sep 17 00:00:00 2001
From: Sergey Fedorov <barracuda@macos-powerpc.org>
Date: Fri, 11 Apr 2025 17:32:40 +0800
Subject: [PATCH 05/60] SettingsWidget.*: compat

---
 src/gui/SettingsWidget.cpp | 47 +++++++++++++++++++++++---------------
 src/gui/SettingsWidget.hpp |  3 +++
 2 files changed, 31 insertions(+), 19 deletions(-)

diff --git a/src/gui/SettingsWidget.cpp b/src/gui/SettingsWidget.cpp
index d5b5a702..61f45f92 100644
--- a/src/gui/SettingsWidget.cpp
+++ b/src/gui/SettingsWidget.cpp
@@ -230,6 +230,31 @@ void SettingsWidget::SetAudioChannels(int chn)
     QMPlay2Core.getSettings().set("ForceChannels", forceChannels);
 }
 
+void SettingsWidget::onStoreARatioAndZoomToggled(bool checked)
+{
+    if (checked)
+    {
+        page2->keepZoom->setChecked(true);
+        page2->keepARatio->setChecked(true);
+    }
+}
+
+void SettingsWidget::onKeepZoomToggled(bool checked)
+{
+    if (!checked && !page2->keepARatio->isChecked())
+    {
+        page2->storeARatioAndZoomB->setChecked(false);
+    }
+}
+
+void SettingsWidget::onKeepARatioToggled(bool checked)
+{
+    if (!checked && !page2->keepZoom->isChecked())
+    {
+        page2->storeARatioAndZoomB->setChecked(false);
+    }
+}
+
 SettingsWidget::SettingsWidget(int page, const QString &moduleName, QWidget *videoEq) :
     videoEq(videoEq), videoEqOriginalParent(videoEq->parentWidget()),
     wasShow(false),
@@ -451,29 +476,13 @@ SettingsWidget::SettingsWidget(int page, const QString &moduleName, QWidget *vid
         page2->wheelVolumeB->setChecked(QMPSettings.getBool("WheelVolume"));
 
         page2->storeARatioAndZoomB->setChecked(QMPSettings.getBool("StoreARatioAndZoom"));
-        connect(page2->storeARatioAndZoomB, &QCheckBox::toggled, this, [this](bool checked) {
-            if (checked)
-            {
-                page2->keepZoom->setChecked(true);
-                page2->keepARatio->setChecked(true);
-            }
-        });
+        connect(page2->storeARatioAndZoomB, SIGNAL(toggled(bool)), this, SLOT(onStoreARatioAndZoomToggled(bool)));
 
         page2->keepZoom->setChecked(QMPSettings.getBool("KeepZoom"));
-        connect(page2->keepZoom, &QCheckBox::toggled, this, [this](bool checked) {
-            if (!checked && !page2->keepARatio->isChecked())
-            {
-                page2->storeARatioAndZoomB->setChecked(false);
-            }
-        });
+        connect(page2->keepZoom, SIGNAL(toggled(bool)), this, SLOT(onKeepZoomToggled(bool)));
 
         page2->keepARatio->setChecked(QMPSettings.getBool("KeepARatio"));
-        connect(page2->keepARatio, &QCheckBox::toggled, this, [this](bool checked) {
-            if (!checked && !page2->keepZoom->isChecked())
-            {
-                page2->storeARatioAndZoomB->setChecked(false);
-            }
-        });
+        connect(page2->keepARatio, SIGNAL(toggled(bool)), this, SLOT(onKeepARatioToggled(bool)));
 
         page2->showBufferedTimeOnSlider->setChecked(QMPSettings.getBool("ShowBufferedTimeOnSlider"));
         page2->savePos->setChecked(QMPSettings.getBool("SavePos"));
diff --git a/src/gui/SettingsWidget.hpp b/src/gui/SettingsWidget.hpp
index b36ac00c..44192c73 100644
--- a/src/gui/SettingsWidget.hpp
+++ b/src/gui/SettingsWidget.hpp
@@ -89,6 +89,9 @@ private slots:
     void resetSettings();
     void profileListIndexChanged(int index);
     void removeProfile();
+    void onStoreARatioAndZoomToggled(bool checked);
+    void onKeepZoomToggled(bool checked);
+    void onKeepARatioToggled(bool checked);
 signals:
     void settingsChanged(int, bool);
     void setWheelStep(int);
-- 
2.49.0

