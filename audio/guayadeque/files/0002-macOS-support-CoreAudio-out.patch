From f9b857712b82072fb265cf13c21ac1a8d422e426 Mon Sep 17 00:00:00 2001
From: Sergey Fedorov <barracuda@macos-powerpc.org>
Date: Tue, 3 Jun 2025 00:21:56 +0800
Subject: [PATCH] macOS: support CoreAudio out

---
 src/audio/FaderPlaybin.cpp         | 1 +
 src/audio/FaderPlaybin.h           | 1 +
 src/ui/preferences/Preferences.cpp | 1 +
 3 files changed, 3 insertions(+)

diff --git a/src/audio/FaderPlaybin.cpp b/src/audio/FaderPlaybin.cpp
index 014f0af0..79d041f2 100644
--- a/src/audio/FaderPlaybin.cpp
+++ b/src/audio/FaderPlaybin.cpp
@@ -571,6 +571,7 @@ bool guFaderPlaybin::BuildOutputBin( void )
         "alsasink",
         "pulsesink",
         "osssink",
+        "osxaudiosink",
         NULL
     };
 
diff --git a/src/audio/FaderPlaybin.h b/src/audio/FaderPlaybin.h
index 01c2b294..fd47b066 100644
--- a/src/audio/FaderPlaybin.h
+++ b/src/audio/FaderPlaybin.h
@@ -48,6 +48,7 @@ enum guOutputDeviceSink {
     guOUTPUT_DEVICE_ALSA,
     guOUTPUT_DEVICE_PULSEAUDIO,
     guOUTPUT_DEVICE_OSS,
+    guOUTPUT_DEVICE_OSXAUDIO,
     guOUTPUT_DEVICE_OTHER
 };
 
diff --git a/src/ui/preferences/Preferences.cpp b/src/ui/preferences/Preferences.cpp
index 1022b48f..3976034c 100644
--- a/src/ui/preferences/Preferences.cpp
+++ b/src/ui/preferences/Preferences.cpp
@@ -973,6 +973,7 @@ void guPrefDialog::BuildPlaybackPage()
     OutputDeviceOptions.Add( wxT( "Alsa" ) );
     OutputDeviceOptions.Add( wxT( "PulseAudio" ) );
     OutputDeviceOptions.Add( wxT( "OSS" ) );
+    OutputDeviceOptions.Add( wxT( "CoreAudio" ) );
     OutputDeviceOptions.Add( wxT( "Other" ) );
 
 	m_PlayOutDevChoice = new wxChoice( m_PlayPanel, wxID_ANY, wxDefaultPosition, wxDefaultSize, OutputDeviceOptions, 0 );
